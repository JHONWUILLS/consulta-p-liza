<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Consulta de Póliza</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: Arial; text-align: center; padding: 20px; background: #eef2f3; }
        .card { background: white; padding: 30px; border-radius: 15px; display: inline-block; width: 90%; max-width: 450px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        h2 { color: #1a73e8; font-size: 26px; }
        p { font-size: 20px; margin: 15px 0; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        /* BOTÓN NARANJA PARA SABER QUÉ ES EL NUEVO */
        .btn { 
            display: block; 
            margin: 20px auto; 
            padding: 18px; 
            background: #ff6600; 
            color: white; 
            text-decoration: none; 
            border-radius: 10px; 
            font-weight: bold; 
            font-size: 22px;
        }
    </style>
</head>
<body>

<div class="card">
    <h2>Póliza Digital</h2>
    <p><strong>Titular:</strong> <span id="txtTitular">...</span></p>
    <p><strong>Placa:</strong> <span id="txtPlaca">...</span></p>
    
    <a id="btnPdf" href="#" class="btn">BUSCANDO PDF...</a>
    
    <div id="msg" style="margin-top:20px; font-weight:bold; color:red;"></div>
</div>

<script>
    const SB_URL = 'https://isspijaaafpewnipdabw.supabase.co'; 
    const SB_KEY = 'sb_publishable_DbYF4urAB8tKJNLzSZnXcw_ZERFTZ-U';
    const supabaseClient = supabase.createClient(SB_URL, SB_KEY);

    async function cargar() {
        try {
            const { data, error } = await supabaseClient.from('Polizas').select('*').limit(1).single();
            
            if (data) {
                document.getElementById('txtTitular').innerText = data.Titular || 'N/A';
                document.getElementById('txtPlaca').innerText = data.Placa || 'N/A';

                const boton = document.getElementById('btnPdf');
                
                // USAMOS EL NOMBRE QUE ME DISTE: Url_pdf
                if (data.Url_pdf) {
                    boton.href = data.Url_pdf;
                    boton.style.background = "#28a745"; // Se pone verde si lo halla
                    boton.innerText = "DESCARGAR PDF AQUÍ";
                } else {
                    boton.style.background = "#888";
                    boton.innerText = "COLUMNA VACÍA EN SUPABASE";
                    document.getElementById('msg').innerText = "El dato en la columna 'Url_pdf' está vacío.";
                }
            }
        } catch (e) {
            document.getElementById('msg').innerText = "Error: " + e.message;
        }
    }
    cargar();
</script>
</body>
</html>
